package cryptography

import (
	"encoding/hex"
	"testing"

	"github.com/stretchr/testify/assert"
)

func TestAesGcmDecrypt(t *testing.T) {
	//{"app":6316061275127559,"t":1687837737,"source":{"data":"fb718b9b023756cd09b388156eb82c345945e7ab590b817150d5049b3e9c6733d87dbe18a3cf67b0f239864cd30d3b762a33ec0efeef2f6a7a30e485261e4aab7f02ee995c19861ca4ab1e5c07dd2d63b9975059ed69e83e5b4b1d1dfae0bfed7cbe1b19a42513e48b5e1ff8e21f7d2c7a5193ded8bdb4588559437cce477da3101682deac44c376d5a6116b950b7ca9977b501abc3dc2860b5940b00bef074135fce6724eff96b64b8fcd13356142456f3a26f6ed0979c8b983872d33d33720617f7027212a8f0ac03155525236625c12571896251b533eb56b2f9e8504a947d2ebf8bb7b4e1084bbae1dbc4c1b9bf8ba60c776b3b393f084e9f443032e822aac1cfc2d9afe0137572c0be663667c072bb981a75a216ef0e3c5d421127d522b494569c19dbf220474e2fd067fd0d43a4fde5f366f00051fc9ffe198245b11a53fd4450bd7d15d5059cd48ee95d016077049a09c9a07370561a011bbf40a9f906515d1c9f73a322b82483a1e451f90cde8576664f535b1cc2fd49a903684315e5497084da96217b9c609fa4b36d7b0bebbfd8115933823","nonce":"47e6abd8736193d3e1f435bd"}}
	key, err := hex.DecodeString("40a779689956f1b58771ad44a1d2bf160feab6269f933c90931b2ea9724f2a35")
	assert.NoError(t, err)
	// nonce, err := hex.DecodeString("47e6abd8736193d3e1f435bd")
	nonce, err := hex.DecodeString("f49d0e32dedd8102a8e4c8cf")
	assert.NoError(t, err)
	// txt, err := hex.DecodeString("fb718b9b023756cd09b388156eb82c345945e7ab590b817150d5049b3e9c6733d87dbe18a3cf67b0f239864cd30d3b762a33ec0efeef2f6a7a30e485261e4aab7f02ee995c19861ca4ab1e5c07dd2d63b9975059ed69e83e5b4b1d1dfae0bfed7cbe1b19a42513e48b5e1ff8e21f7d2c7a5193ded8bdb4588559437cce477da3101682deac44c376d5a6116b950b7ca9977b501abc3dc2860b5940b00bef074135fce6724eff96b64b8fcd13356142456f3a26f6ed0979c8b983872d33d33720617f7027212a8f0ac03155525236625c12571896251b533eb56b2f9e8504a947d2ebf8bb7b4e1084bbae1dbc4c1b9bf8ba60c776b3b393f084e9f443032e822aac1cfc2d9afe0137572c0be663667c072bb981a75a216ef0e3c5d421127d522b494569c19dbf220474e2fd067fd0d43a4fde5f366f00051fc9ffe198245b11a53fd4450bd7d15d5059cd48ee95d016077049a09c9a07370561a011bbf40a9f906515d1c9f73a322b82483a1e451f90cde8576664f535b1cc2fd49a903684315e5497084da96217b9c609fa4b36d7b0bebbfd8115933823")
	txt, err := hex.DecodeString("edb0f7406d835cec9163c32821b26cc31541d4a2c9d4e79f1924b5e9885e9625dbfa16d2ed79e004605d03991ac40bbc278b3493a1ffaf9a5577a92d6493dd7190d663dec053206053443647aa0d33d85bc1cd070b2983246c7418e7397647a14cf2e5f3a12a202d08384b0f10d4d0140c2337d9d3873d80ac0bda9d697b4122f67e26a3d0f9ecb38ed43506bd3cd3a8115dc0fc2c578949a66d223462896ea64e37b1c300bccd7bfbb235aaf3a9885293b939f2b17be7366d87041c9c0b4211788dc94a12267fe2ca22995c98c45dfb76972c0fe0ff229533d42dfa19dfdeba84f277bd04088bfe4d286ef48da09b9877b454323569a42d41183c2b85e055be226bc64c138ec3498ed2da5a73d1666457d9949780d3151c971c98ce98653fed074895d722bf0ee0557ab193885db33738d8a9192a96164852a22f0d52cf1953f3be4e7bbe08248925ce1cea08cfcc65c39a4f9f971f09b91596153f9b32d1f513d9ae63d800b686eca1f0dc46e360680aa7f1dd9adfe69b275b9dc06067f77dc3a7e846c2a51ba3e292a0fdd0934f5670eae2a9")
	assert.NoError(t, err)
	result, err := AesGcmDecrypt([]byte(txt), []byte(key), []byte(nonce))
	assert.NoError(t, err)
	t.Log(result)

}
